import{_ as e}from"./index-C-jnPPYH.js";import{d as a,r as l,S as t,c as i,w as n,J as s,f as o,W as r,a as d,g as u,h as c,e as f,_ as v,C as p,t as m,G as y,a0 as h,o as k,M as x,x as g}from"./index-BAyZi_co.js";import{u as _}from"./index-FaVgdj3V.js";import{g as w}from"./generator-Iuzxk3cN.js";const j={class:"preview-content"},z=g(a({__name:"GenPreviewModal",emits:["download","generate"],setup(a,{expose:g,emit:z}){const L=z,{copy:b,copied:N}=_(),C=l([]),A=l(),$=l(!1),q=l([]),G=l(),M=l([]),O=e=>{var a;if(1===(null==(a=e.children)?void 0:a.length)&&"number"==typeof e.children[0].key){const a=O(e.children[0]);return""!==a&&(e.title=`${e.title}/${a}`),e.children=e.children[0].children,e.title}if(null==e?void 0:e.children)for(const l of e.children)O(l);return e.title},P=(e,a)=>{if(e)for(const l of e)if(l.title===a.title)return l.children;return null==e||e.push(a),a.children};let S=0;const W=e=>{const a=e.path.includes("/")?"/":"\\",l=e.path.split(a);let t=M.value;for(const i of l)t=P(t,{title:i,key:S++,children:new Array});null==t||t.push({title:e.fileName,key:e.fileName,children:new Array})},E=()=>{L("download",[q.value])},I=()=>{L("generate",[q.value])},J=(e,a)=>e.endsWith(a),R=()=>{var e;A.value&&b(null==(e=A.value)?void 0:e.content)};t(N,(()=>{N.value&&x.success("复制成功")}));const U=l(),B=e=>{if("string"==typeof e[0])A.value=C.value.filter((a=>a.fileName===e[0]))[0],U.value=e;else{const a=G.value.getExpandedNodes().map((e=>e.key));G.value.expandNode(e[0],!a.includes(e[0]))}};return g({onOpen:async e=>{M.value=[],q.value=e;const{data:a}=await w(e);C.value=a;for(const l of C.value)W(l);for(const l of M.value)O(l);U.value=[C.value[0].fileName],A.value=C.value[0],await r((()=>{G.value.expandAll(!0)})),$.value=!0}}),(a,l)=>{const t=d("a-link"),r=d("icon-caret-down"),x=v,g=d("a-tree"),_=d("a-layout-sider"),w=d("a-typography-title"),z=d("icon-copy"),L=e,b=d("a-scrollbar"),N=d("a-card"),C=d("a-layout-content"),O=d("a-layout"),P=d("a-modal"),S=h("permission");return k(),i(P,{visible:o($),"onUpdate:visible":l[0]||(l[0]=e=>s($)?$.value=e:null),width:"90%",footer:!1},{title:n((()=>[p(m(1===o(q).length?`生成 ${o(q)[0]} 表预览`:"批量生成预览")+" ",1),y((k(),i(t,{style:{"margin-left":"10px"},icon:"",onClick:E},{default:n((()=>l[1]||(l[1]=[p("下载源码")]))),_:1})),[[S,["code:generator:generate"]]]),y((k(),i(t,{style:{"margin-left":"10px"},icon:"",onClick:I},{default:n((()=>l[2]||(l[2]=[p("生成源码")]))),_:1})),[[S,["code:generator:generate"]]])])),default:n((()=>[u("div",j,[c(O,{"has-sider":!0},{default:n((()=>[c(_,{theme:"dark",style:{"max-width":"600px",height:"700px"},"resize-directions":["right"],width:370},{default:n((()=>[c(g,{ref_key:"treeRef",ref:G,data:o(M),"show-line":"","block-node":"","selected-keys":o(U),class:"selectPreview",onSelect:B},{"switcher-icon":n(((e,{isLeaf:a})=>[a?f("",!0):(k(),i(r,{key:0}))])),icon:n((e=>[e.isLeaf||e.expanded?f("",!0):(k(),i(x,{key:0,size:16,name:"directory-blue"})),!e.isLeaf&&e.expanded?(k(),i(x,{key:1,size:16,name:"directory-open-blue"})):f("",!0),e.isLeaf&&J(e.node.title,".java")?(k(),i(x,{key:2,size:16,name:"file-java"})):f("",!0),e.isLeaf&&J(e.node.title,".vue")?(k(),i(x,{key:3,size:16,name:"file-vue"})):f("",!0),e.isLeaf&&J(e.node.title,".ts")?(k(),i(x,{key:4,size:16,name:"file-typescript"})):f("",!0),e.isLeaf&&J(e.node.title,".js")?(k(),i(x,{key:5,size:16,name:"file-javascript"})):f("",!0),e.isLeaf&&J(e.node.title,".json")?(k(),i(x,{key:6,size:16,name:"file-json"})):f("",!0),e.isLeaf&&J(e.node.title,"pom.xml")?(k(),i(x,{key:7,size:16,name:"file-maven"})):f("",!0),e.isLeaf&&J(e.node.title,".xml")&&!J(e.node.title,"pom.xml")?(k(),i(x,{key:8,size:16,name:"file-xml"})):f("",!0),e.isLeaf&&J(e.node.title,".sql")?(k(),i(x,{key:9,size:16,name:"file-sql"})):f("",!0)])),_:1},8,["data","selected-keys"])])),_:1}),c(C,null,{default:n((()=>[c(N,null,{title:n((()=>[c(w,{heading:6,ellipsis:""},{default:n((()=>{var e,a,l;return[p(m(null==(e=o(A))?void 0:e.path)+m(-1!==(null==(a=o(A))?void 0:a.path.indexOf("/"))?"/":"\\")+m(null==(l=o(A))?void 0:l.fileName),1)]})),_:1})])),default:n((()=>[c(b,{style:{height:"650px",overflow:"auto"}},{default:n((()=>{var e,a;return[c(t,{style:{position:"absolute",right:"20px","z-index":"999"},title:"复制",onClick:R},{icon:n((()=>[c(z,{size:"large"})])),default:n((()=>l[3]||(l[3]=[p("复制")]))),_:1}),c(L,{type:"vue"===(null==(e=o(A))?void 0:e.fileName.split(".")[1])?"vue":"javascript","code-json":null==(a=o(A))?void 0:a.content},null,8,["type","code-json"])]})),_:1})])),_:1})])),_:1})])),_:1})])])),_:1},8,["visible"])}}}),[["__scopeId","data-v-2f262a35"]]);export{z as default};
