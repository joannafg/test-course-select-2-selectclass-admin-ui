import{d as e,r as a,A as s,c as l,w as o,f as r,a as d,h as n,C as t,k as w,o as i,M as u,x as p}from"./index-BAyZi_co.js";import{u as c}from"./user-center-DOjaikc1.js";import{e as m}from"./encrypt-fe7GwHAY.js";import"./index-DVDBkEOF.js";const f=p(e({__name:"index",setup(e){const p=a(),f=s({oldPassword:"",newPassword:"",confirmPassword:""}),P={oldPassword:[{required:!0,message:"please enter current password"}],newPassword:[{required:!0,message:"please enter new password"},{validator:(e,a)=>new Promise((s=>{e===f.oldPassword&&a("new password cannot be the same as the old password"),s(!0)}))}],confirmPassword:[{required:!0,message:"please enter new password again"},{validator:(e,a)=>new Promise((s=>{e!==f.newPassword&&a("the two passwords are inconsistent"),s(!0)}))}]},y=w(),g=a(!1),h=async()=>{var e;if(!(await(null==(e=p.value)?void 0:e.validate())))try{g.value=!0;const e={oldPassword:m(f.oldPassword)||"",newPassword:m(f.newPassword)||""};await c(e),y.push({path:"/login"}),u.success("modify successfully")}catch(a){}finally{g.value=!1}};return(e,a)=>{const s=d("a-input-password"),w=d("a-form-item"),u=d("a-button"),c=d("a-space"),m=d("a-form");return i(),l(m,{ref_key:"formRef",ref:p,model:r(f),rules:P,layout:"vertical","label-col-style":{lineHeight:"10px"},"wrapper-col-style":{flex:1},size:"large",onSubmit:h},{default:o((()=>[n(w,{field:"oldPassword",label:"current password"},{default:o((()=>[n(s,{modelValue:r(f).oldPassword,"onUpdate:modelValue":a[0]||(a[0]=e=>r(f).oldPassword=e),placeholder:"please enter current password","allow-clear":""},null,8,["modelValue"])])),_:1}),n(w,{field:"newPassword",label:"new password"},{default:o((()=>[n(s,{modelValue:r(f).newPassword,"onUpdate:modelValue":a[1]||(a[1]=e=>r(f).newPassword=e),placeholder:"please enter new password","allow-clear":""},null,8,["modelValue"])])),_:1}),n(w,{field:"confirmPassword",label:"confirm password"},{default:o((()=>[n(s,{modelValue:r(f).confirmPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>r(f).confirmPassword=e),placeholder:"please enter new password again","allow-clear":""},null,8,["modelValue"])])),_:1}),n(w,null,{default:o((()=>[n(c,{direction:"vertical",fill:"",class:"w-full"},{default:o((()=>[n(u,{class:"btn",type:"primary",loading:r(g),"html-type":"submit",size:"large",long:""},{default:o((()=>a[3]||(a[3]=[t(" 立即修改 ")]))),_:1},8,["loading"])])),_:1})])),_:1})])),_:1},8,["model"])}}}),[["__scopeId","data-v-67fc172e"]]);export{f as default};
