import{b as e}from"./index-FaVgdj3V.js";import{g as l,u as a,a as s}from"./teacher-AO1vI7zE.js";import{_ as t}from"./GiForm-BWZRNfN-.js";import{d as r,r as o,p,A as i,c as u,w as n,f as d,J as c,a as m,h,o as f,M as v}from"./index-BAyZi_co.js";import{u as g}from"./useResetReactive-NMdkdCz2.js";import{u as b}from"./useDept-CXLwDhMr.js";import{u as y}from"./useDict-ConFaTXJ.js";const w=r({__name:"TeacherAddModal",emits:["save-success"],setup(r,{expose:w,emit:_}){const j=_,{width:q}=e(),R=o(""),k=o(!1),x=p((()=>!!R.value)),C=p((()=>x.value?"修改教师管理":"新增教师管理")),L=o(),{teacher_status:A,gender_type:D}=y("teacher_status","gender_type"),{deptList:O,getDeptList:T}=b(),U={form:{size:"large"},btns:{hide:!0}},[V,F]=g({}),M=i([{label:"teacher number",field:"teacherNo",type:"input",props:{placeholder:"please enter the teacher number"},rules:[{required:!0,message:"please enter the teacher number"}]},{label:"name",field:"name",type:"input",props:{placeholder:"please enter the name"},rules:[{required:!0,message:"please enter the name"}]},{label:"gender",field:"gender",type:"select",props:{placeholder:"please select the gender"},options:D,rules:[{required:!0,message:"please enter the gender"}]},{label:"title",field:"title",type:"input",props:{placeholder:"please enter the title"}},{label:"phone",field:"phone",type:"input",props:{placeholder:"please enter the phone"}},{label:"email",field:"email",type:"input",props:{placeholder:"please enter the email"}},{label:"college",field:"collegeId",type:"tree-select",data:O,props:{placeholder:"please enter the college",allowClear:!0,allowSearch:!0,fallbackOption:!1,filterTreeNode:(e,l)=>!!l.title&&l.title.toLowerCase().includes(e.toLowerCase())},rules:[{required:!0,message:"please enter the college"}]},{label:"status",field:"status",type:"select",props:{placeholder:"please select the status"},options:A,rules:[{required:!0,message:"please enter the status"}]}]),N=()=>{var e,l;null==(l=null==(e=L.value)?void 0:e.formRef)||l.resetFields(),F()},z=async()=>{var e,l;try{return!(await(null==(l=null==(e=L.value)?void 0:e.formRef)?void 0:l.validate()))&&(x.value?(await a(V,R.value),v.success("modify successfully")):(await s(V),v.success("add successfully")),j("save-success"),!0)}catch(t){return!1}};return w({onAdd:async()=>{await T(),N(),R.value="",k.value=!0},onUpdate:async e=>{N(),R.value=e;const{data:a}=await l(e);Object.assign(V,a),k.value=!0}}),(e,l)=>{const a=m("a-modal");return f(),u(a,{visible:d(k),"onUpdate:visible":l[1]||(l[1]=e=>c(k)?k.value=e:null),title:d(C),"mask-closable":!1,"esc-to-close":!1,width:d(q)>=600?600:"100%",draggable:"",onBeforeOk:z,onClose:N},{default:n((()=>[h(d(t),{ref_key:"formRef",ref:L,modelValue:d(V),"onUpdate:modelValue":l[0]||(l[0]=e=>c(V)?V.value=e:null),options:U,columns:d(M)},null,8,["modelValue","columns"])])),_:1},8,["visible","title","width"])}}});export{w as _};
