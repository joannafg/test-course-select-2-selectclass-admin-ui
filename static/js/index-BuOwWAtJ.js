import{_ as e}from"./index-DBV9O_Xv.js";import{d as a,r as l,A as t,L as s,c as o,w as c,f as n,a as r,h as u,C as i,t as p,k as d,o as h,M as m,x as f}from"./index-BAyZi_co.js";import{P as v}from"./regexp-DaVwsOyC.js";import{u as g}from"./tabs-D4ctZ4n_.js";import"./captcha-noq_IUbv.js";import"./encrypt-fe7GwHAY.js";import"./index-DVDBkEOF.js";const y=f(a({__name:"index",setup(a){const f=l(),y=t({phone:"",captcha:""}),w={phone:[{required:!0,message:"please enter phone number"},{match:v,message:"please enter correct phone number"}],captcha:[{required:!0,message:"please enter captcha"}]},b=s(),_=g(),x=d(),j=l(!1),V=async()=>{var e;if(!(await(null==(e=f.value)?void 0:e.validate())))try{j.value=!0,await b.phoneLogin(y),_.reset();const{redirect:e,...a}=x.currentRoute.value.query;await x.push({path:e||"/",query:{...a}}),m.success("welcome to use")}catch(a){y.captcha=""}finally{j.value=!1}},z=l(),k=l("blockPuzzle"),q=l("pop"),I=l(!1),R=async()=>{var e;if(I.value)return;await(null==(e=f.value)?void 0:e.validateField("phone"))||(z.value.instance.refresh(),z.value.show())},C=l(),L=l(60),P=l("get captcha"),S=l(!1),U=()=>{window.clearInterval(C.value),L.value=60,P.value="get captcha",S.value=!1},$=async e=>{try{I.value=!0,P.value="sending...",I.value=!1,S.value=!0,P.value=`get captcha(${L.value-=1}s)`,m.success("only for demonstration, please view the code to cancel the relevant comments for actual use"),C.value=window.setInterval((()=>{L.value-=1,P.value=`get captcha(${L.value}s)`,L.value<=0&&U()}),1e3)}catch(a){U()}finally{I.value=!1}};return(a,l)=>{const t=r("a-input"),s=r("a-form-item"),d=r("a-button"),m=r("a-space"),v=e,g=r("a-form");return h(),o(g,{ref_key:"formRef",ref:f,model:n(y),rules:w,"label-col-style":{display:"none"},"wrapper-col-style":{flex:1},size:"large",onSubmit:V},{default:c((()=>[u(s,{field:"phone","hide-label":""},{default:c((()=>[u(t,{modelValue:n(y).phone,"onUpdate:modelValue":l[0]||(l[0]=e=>n(y).phone=e),placeholder:"please enter phone number","max-length":11,"allow-clear":""},null,8,["modelValue"])])),_:1}),u(s,{field:"captcha","hide-label":""},{default:c((()=>[u(t,{modelValue:n(y).captcha,"onUpdate:modelValue":l[1]||(l[1]=e=>n(y).captcha=e),placeholder:"please enter captcha","max-length":4,"allow-clear":"",style:{flex:"1 1"}},null,8,["modelValue"]),u(d,{class:"captcha-btn",loading:n(I),disabled:n(S),size:"large",onClick:R},{default:c((()=>[i(p(n(P)),1)])),_:1},8,["loading","disabled"])])),_:1}),u(s,null,{default:c((()=>[u(m,{direction:"vertical",fill:"",class:"w-full"},{default:c((()=>[u(d,{disabled:"",class:"btn",type:"primary",loading:n(j),"html-type":"submit",size:"large",long:""},{default:c((()=>l[2]||(l[2]=[i("login")]))),_:1},8,["loading"])])),_:1})])),_:1}),u(v,{ref_key:"VerifyRef",ref:z,"captcha-type":n(k),mode:n(q),"img-size":{width:"330px",height:"155px"},onSuccess:$},null,8,["captcha-type","mode"])])),_:1},8,["model"])}}}),[["__scopeId","data-v-499e171c"]]);export{y as default};
