import{b as e}from"./index-FaVgdj3V.js";import{d as a,r as S,B as _,c as l,a as R,f as O,w as A,h as t,C as s,G as i,e as u,M as d,O as n,a0 as o,o as E,x as I}from"./index-BAyZi_co.js";import{l as N,u as P,r}from"./option-1orMv3he.js";import{u as D}from"./useResetReactive-NMdkdCz2.js";const W=I(a({name:"SecuritySetting",__name:"SecuritySetting",setup(a){const{width:I}=e(),W=S(!1),T=S(),[c]=D({PASSWORD_ERROR_LOCK_COUNT:0,PASSWORD_ERROR_LOCK_MINUTES:0,PASSWORD_EXPIRATION_DAYS:0,PASSWORD_EXPIRATION_WARNING_DAYS:0,PASSWORD_REPETITION_TIMES:0,PASSWORD_MIN_LENGTH:0,PASSWORD_ALLOW_CONTAIN_USERNAME:0,PASSWORD_REQUIRE_SYMBOLS:0}),m={PASSWORD_ERROR_LOCK_COUNT:[{required:!0,message:"please enter the value"}],PASSWORD_ERROR_LOCK_MINUTES:[{required:!0,message:"please enter the value"}],PASSWORD_EXPIRATION_DAYS:[{required:!0,message:"please enter the value"}],PASSWORD_EXPIRATION_WARNING_DAYS:[{required:!0,message:"please enter the value"},{validator:(e,a)=>{c.PASSWORD_EXPIRATION_DAYS>0&&e>=c.PASSWORD_EXPIRATION_DAYS?a("the password expiration warning time should be less than the password expiration time"):a()}}],PASSWORD_REPETITION_TIMES:[{required:!0,message:"please enter the value"}],PASSWORD_MIN_LENGTH:[{required:!0,message:"please enter the value"}]},p=S({PASSWORD_ERROR_LOCK_COUNT:{},PASSWORD_ERROR_LOCK_MINUTES:{},PASSWORD_EXPIRATION_DAYS:{},PASSWORD_EXPIRATION_WARNING_DAYS:{},PASSWORD_REPETITION_TIMES:{},PASSWORD_MIN_LENGTH:{},PASSWORD_ALLOW_CONTAIN_USERNAME:{},PASSWORD_REQUIRE_SYMBOLS:{}}),L=()=>{var e;null==(e=T.value)||e.resetFields(),c.PASSWORD_ERROR_LOCK_COUNT=p.value.PASSWORD_ERROR_LOCK_COUNT.value||0,c.PASSWORD_ERROR_LOCK_MINUTES=p.value.PASSWORD_ERROR_LOCK_MINUTES.value||0,c.PASSWORD_EXPIRATION_DAYS=p.value.PASSWORD_EXPIRATION_DAYS.value||0,c.PASSWORD_EXPIRATION_WARNING_DAYS=p.value.PASSWORD_EXPIRATION_WARNING_DAYS.value||0,c.PASSWORD_REPETITION_TIMES=p.value.PASSWORD_REPETITION_TIMES.value||0,c.PASSWORD_MIN_LENGTH=p.value.PASSWORD_MIN_LENGTH.value||0,c.PASSWORD_ALLOW_CONTAIN_USERNAME=p.value.PASSWORD_ALLOW_CONTAIN_USERNAME.value||0,c.PASSWORD_REQUIRE_SYMBOLS=p.value.PASSWORD_REQUIRE_SYMBOLS.value||0},h=S(!1),v=()=>{h.value=!0},f=()=>{L(),h.value=!1},M={category:"PASSWORD"},C=async()=>{W.value=!0;const{data:e}=await N(M);p.value=e.reduce(((e,a)=>(e[a.code]={...a,value:Number.parseInt(a.value)},e)),{}),f(),W.value=!1},U=async()=>{var e;if(await(null==(e=T.value)?void 0:e.validate()))return!1;await P(Object.entries(c).map((([e,a])=>({id:p.value[e].id,code:e,value:a})))),await C(),d.success("save successfully")},y=async()=>{await r(M),d.success("restore successfully"),await C()},Y=()=>{n.warning({title:"warning",content:"are you sure to restore the security configuration to the default value?",hideCancel:!1,maskClosable:!1,onOk:y})};return _((()=>{C()})),(e,a)=>{const S=R("a-input-number"),_=R("a-form-item"),d=R("a-switch"),n=R("icon-edit"),N=R("a-button"),P=R("icon-undo"),r=R("icon-save"),D=R("icon-refresh"),M=R("a-space"),C=R("a-form"),y=R("a-spin"),b=o("permission");return E(),l(y,{loading:O(W)},{default:A((()=>[t(C,{ref_key:"formRef",ref:T,model:O(c),rules:m,"auto-label-width":"","label-align":"left",layout:O(I)>=500?"horizontal":"vertical",disabled:!O(h),"scroll-to-first-error":""},{default:A((()=>[t(_,{field:"PASSWORD_ERROR_LOCK_COUNT",label:O(p).PASSWORD_ERROR_LOCK_COUNT.name,help:O(p).PASSWORD_ERROR_LOCK_COUNT.description,"hide-asterisk":""},{default:A((()=>[t(S,{modelValue:O(c).PASSWORD_ERROR_LOCK_COUNT,"onUpdate:modelValue":a[0]||(a[0]=e=>O(c).PASSWORD_ERROR_LOCK_COUNT=e),class:"input-width","default-value":0,precision:0,min:0,max:10},{append:A((()=>a[8]||(a[8]=[s("times")]))),_:1},8,["modelValue"])])),_:1},8,["label","help"]),t(_,{field:"PASSWORD_ERROR_LOCK_MINUTES",label:O(p).PASSWORD_ERROR_LOCK_MINUTES.name,help:O(p).PASSWORD_ERROR_LOCK_MINUTES.description,"hide-asterisk":""},{default:A((()=>[t(S,{modelValue:O(c).PASSWORD_ERROR_LOCK_MINUTES,"onUpdate:modelValue":a[1]||(a[1]=e=>O(c).PASSWORD_ERROR_LOCK_MINUTES=e),class:"input-width",precision:0,min:1,max:1440},{append:A((()=>a[9]||(a[9]=[s("minutes")]))),_:1},8,["modelValue"])])),_:1},8,["label","help"]),t(_,{field:"PASSWORD_EXPIRATION_DAYS",label:O(p).PASSWORD_EXPIRATION_DAYS.name,help:O(p).PASSWORD_EXPIRATION_DAYS.description,"hide-asterisk":""},{default:A((()=>[t(S,{modelValue:O(c).PASSWORD_EXPIRATION_DAYS,"onUpdate:modelValue":a[2]||(a[2]=e=>O(c).PASSWORD_EXPIRATION_DAYS=e),class:"input-width",precision:0,min:0,max:999},{append:A((()=>a[10]||(a[10]=[s("days")]))),_:1},8,["modelValue"])])),_:1},8,["label","help"]),t(_,{label:O(p).PASSWORD_EXPIRATION_WARNING_DAYS.name,field:"PASSWORD_EXPIRATION_WARNING_DAYS",help:O(p).PASSWORD_EXPIRATION_WARNING_DAYS.description,"hide-asterisk":""},{default:A((()=>[t(S,{modelValue:O(c).PASSWORD_EXPIRATION_WARNING_DAYS,"onUpdate:modelValue":a[3]||(a[3]=e=>O(c).PASSWORD_EXPIRATION_WARNING_DAYS=e),class:"input-width",precision:0,min:0,max:998},{append:A((()=>a[11]||(a[11]=[s("days")]))),_:1},8,["modelValue"])])),_:1},8,["label","help"]),t(_,{field:"PASSWORD_REPETITION_TIMES",label:O(p).PASSWORD_REPETITION_TIMES.name,help:O(p).PASSWORD_REPETITION_TIMES.description,"hide-asterisk":""},{default:A((()=>[t(S,{modelValue:O(c).PASSWORD_REPETITION_TIMES,"onUpdate:modelValue":a[4]||(a[4]=e=>O(c).PASSWORD_REPETITION_TIMES=e),class:"input-width",precision:0,min:3,max:32},{append:A((()=>a[12]||(a[12]=[s("times")]))),_:1},8,["modelValue"])])),_:1},8,["label","help"]),t(_,{field:"PASSWORD_MIN_LENGTH",label:O(p).PASSWORD_MIN_LENGTH.name,help:O(p).PASSWORD_MIN_LENGTH.description,"hide-asterisk":""},{default:A((()=>[t(S,{modelValue:O(c).PASSWORD_MIN_LENGTH,"onUpdate:modelValue":a[5]||(a[5]=e=>O(c).PASSWORD_MIN_LENGTH=e),class:"input-width",precision:0,min:8,max:32},null,8,["modelValue"])])),_:1},8,["label","help"]),t(_,{field:"PASSWORD_ALLOW_CONTAIN_USERNAME",label:O(p).PASSWORD_ALLOW_CONTAIN_USERNAME.name},{default:A((()=>[t(d,{modelValue:O(c).PASSWORD_ALLOW_CONTAIN_USERNAME,"onUpdate:modelValue":a[6]||(a[6]=e=>O(c).PASSWORD_ALLOW_CONTAIN_USERNAME=e),type:"round","checked-value":1,"unchecked-value":0},{checked:A((()=>a[13]||(a[13]=[s("yes")]))),unchecked:A((()=>a[14]||(a[14]=[s("no")]))),_:1},8,["modelValue"])])),_:1},8,["label"]),t(_,{field:"PASSWORD_REQUIRE_SYMBOLS",label:O(p).PASSWORD_REQUIRE_SYMBOLS.name},{default:A((()=>[t(d,{modelValue:O(c).PASSWORD_REQUIRE_SYMBOLS,"onUpdate:modelValue":a[7]||(a[7]=e=>O(c).PASSWORD_REQUIRE_SYMBOLS=e),type:"round","checked-value":1,"unchecked-value":0},{checked:A((()=>a[15]||(a[15]=[s("yes")]))),unchecked:A((()=>a[16]||(a[16]=[s("no")]))),_:1},8,["modelValue"])])),_:1},8,["label"]),t(M,{style:{"margin-bottom":"16px"}},{default:A((()=>[O(h)?u("",!0):i((E(),l(N,{key:0,type:"primary",onClick:v},{icon:A((()=>[t(n)])),default:A((()=>[a[17]||(a[17]=s("modify "))])),_:1})),[[b,["system:config:update"]]]),O(h)?u("",!0):i((E(),l(N,{key:1,onClick:Y},{icon:A((()=>[t(P)])),default:A((()=>[a[18]||(a[18]=s("restore "))])),_:1})),[[b,["system:config:reset"]]]),O(h)?(E(),l(N,{key:2,type:"primary",onClick:U},{icon:A((()=>[t(r)])),default:A((()=>[a[19]||(a[19]=s("save "))])),_:1})):u("",!0),O(h)?(E(),l(N,{key:3,onClick:L},{icon:A((()=>[t(D)])),default:A((()=>[a[20]||(a[20]=s("reset "))])),_:1})):u("",!0),O(h)?(E(),l(N,{key:4,onClick:f},{icon:A((()=>[t(P)])),default:A((()=>[a[21]||(a[21]=s("cancel "))])),_:1})):u("",!0)])),_:1})])),_:1},8,["model","layout","disabled"])])),_:1},8,["loading"])}}}),[["__scopeId","data-v-2942144f"]]);export{W as default};
