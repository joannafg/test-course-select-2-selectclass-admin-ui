import{aw as e,M as t}from"./index-BAyZi_co.js";const n=async(n,o=!1,a="",i=".xlsx")=>{try{const d=await n();if(a=d.headers["content-disposition"]?decodeURI(d.headers["content-disposition"].split(";")[1].split("=")[1]):a||(new Date).getTime()+i,o&&!(null==d?void 0:d.code)&&e.warning({title:"温馨提示",content:"如果数据庞大会导致下载缓慢哦，请您耐心等待！"}),200!==d.status||null==d.data||!(d.data instanceof Blob))return void t.error("导出失败，请稍后再试！");const s=new Blob([d.data]);"msSaveOrOpenBlob"in navigator&&window.navigator.msSaveOrOpenBlob(s,a+i);const c=window.URL.createObjectURL(s),r=document.createElement("a");r.style.display="none",r.download=a,r.href=c,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(c)}catch(d){}};export{n as u};
