import{_ as e}from"./index-B7Sos0mo.js";import{_ as t}from"./GiCellStatus.vue_vue_type_script_setup_true_lang-27S6yIFO.js";import{d as a,A as l,r as i,p as s,a1 as n,b as o,h as d,w as r,f as u,a as c,G as m,c as p,C as y,e as f,g as h,_,t as x,J as k,a0 as v,o as g}from"./index-BAyZi_co.js";import{_ as b,l as I,d as C}from"./MenuAddModal.vue_vue_type_script_setup_true_lang-DeHbmPvw.js";import{u as w}from"./useTable-DUTUCT70.js";import{h as j}from"./has-CF2CDZHh.js";import"./index-FaVgdj3V.js";import"./useResetReactive-NMdkdCz2.js";import"./useBreakpoint-C2fvcUp5.js";const N={class:"gi_table_page"},R={style:{"margin-left":"5px","vertical-align":"middle"}},S=a({name:"SystemMenu",__name:"index",setup(a){const S=l({}),{tableData:z,loading:M,search:A,handleDelete:E}=w((()=>I(S)),{immediate:!0}),H=i(""),U=s((()=>H.value?(e=>{const t=a=>{const l=[];return a.forEach((a=>{var i;if(null==(i=a.title)?void 0:i.toLowerCase().includes(e.toLowerCase()))l.push({...a});else if(a.children){const e=t(a.children);e.length&&l.push({...a,children:e})}})),l};return t(z.value)})(H.value):z.value)),D=[{title:"menu title",dataIndex:"title",slotName:"title",width:170,fixed:n()?void 0:"left"},{title:"type",dataIndex:"type",slotName:"type",align:"center"},{title:"status",dataIndex:"status",slotName:"status",align:"center"},{title:"sort",dataIndex:"sort",align:"center",show:!1},{title:"route address",dataIndex:"path",ellipsis:!0,tooltip:!0},{title:"component name",dataIndex:"name",ellipsis:!0,tooltip:!0},{title:"component path",dataIndex:"component",minWidth:180,ellipsis:!0,tooltip:!0},{title:"permission",dataIndex:"permission",minWidth:180,ellipsis:!0,tooltip:!0},{title:"external link",dataIndex:"isExternal",slotName:"isExternal",align:"center"},{title:"hidden",dataIndex:"isHidden",slotName:"isHidden",align:"center"},{title:"cache",dataIndex:"isCache",slotName:"isCache",align:"center"},{title:"create user",dataIndex:"createUserString",ellipsis:!0,tooltip:!0,show:!1},{title:"create time",dataIndex:"createTime",width:180},{title:"update user",dataIndex:"updateUserString",ellipsis:!0,tooltip:!0,show:!1},{title:"update time",dataIndex:"updateTime",width:180,show:!1},{title:"action",dataIndex:"action",slotName:"action",width:160,align:"center",fixed:n()?void 0:"right",show:j.hasPermOr(["system:menu:update","system:menu:delete","system:menu:add"])}],T=()=>{H.value=""},V=i(!1),W=i(),G=()=>{var e,t;V.value=!V.value,null==(t=null==(e=W.value)?void 0:e.tableRef)||t.expandAll(V.value)},J=i(),L=e=>{var t;null==(t=J.value)||t.onAdd(e)};return(a,l)=>{const i=c("IconDown"),s=c("IconRight"),n=c("icon-search"),I=c("a-input"),w=c("icon-refresh"),j=c("a-button"),S=c("icon-plus"),z=c("icon-list"),q=c("icon-mind-mapping"),B=c("a-tooltip"),O=_,P=c("a-tag"),$=t,F=c("a-link"),K=c("a-space"),Q=e,X=v("permission");return g(),o("div",N,[d(Q,{ref_key:"tableRef",ref:W,title:"","row-key":"id",data:u(U),columns:D,loading:u(M),scroll:{x:"100%",y:"100%",minWidth:1700},pagination:!1,"disabled-column-keys":["title"],onRefresh:u(A)},{"expand-icon":r((({expanded:e})=>[e?(g(),p(i,{key:0})):(g(),p(s,{key:1}))])),"toolbar-left":r((()=>[d(I,{modelValue:u(H),"onUpdate:modelValue":l[0]||(l[0]=e=>k(H)?H.value=e:null),placeholder:"search menu title","allow-clear":""},{prefix:r((()=>[d(n)])),_:1},8,["modelValue"]),d(j,{onClick:T},{icon:r((()=>[d(w)])),default:r((()=>l[2]||(l[2]=[y("reset")]))),_:1})])),"toolbar-right":r((()=>[m((g(),p(j,{type:"primary",onClick:l[1]||(l[1]=e=>L())},{icon:r((()=>[d(S)])),default:r((()=>l[3]||(l[3]=[y("add")]))),_:1})),[[X,["system:menu:add"]]]),d(B,{content:"expand/collapse"},{default:r((()=>[d(j,{onClick:G},{icon:r((()=>[u(V)?(g(),p(q,{key:1})):(g(),p(z,{key:0}))])),_:1})])),_:1})])),title:r((({record:e})=>[d(O,{name:e.icon,size:15},null,8,["name"]),h("span",R,x(e.title),1)])),type:r((({record:e})=>[1===e.type?(g(),p(P,{key:0,color:"arcoblue"},{default:r((()=>l[4]||(l[4]=[y("directory")]))),_:1})):f("",!0),2===e.type?(g(),p(P,{key:1,color:"green"},{default:r((()=>l[5]||(l[5]=[y("menu")]))),_:1})):f("",!0),3===e.type?(g(),p(P,{key:2},{default:r((()=>l[6]||(l[6]=[y("button")]))),_:1})):f("",!0)])),status:r((({record:e})=>[d($,{status:e.status},null,8,["status"])])),isExternal:r((({record:e})=>[e.isExternal?(g(),p(P,{key:0,color:"arcoblue",size:"small"},{default:r((()=>l[7]||(l[7]=[y("yes")]))),_:1})):(g(),p(P,{key:1,color:"red",size:"small"},{default:r((()=>l[8]||(l[8]=[y("no")]))),_:1}))])),isHidden:r((({record:e})=>[e.isHidden?(g(),p(P,{key:0,color:"arcoblue",size:"small"},{default:r((()=>l[9]||(l[9]=[y("yes")]))),_:1})):(g(),p(P,{key:1,color:"red",size:"small"},{default:r((()=>l[10]||(l[10]=[y("no")]))),_:1}))])),isCache:r((({record:e})=>[e.isCache?(g(),p(P,{key:0,color:"arcoblue",size:"small"},{default:r((()=>l[11]||(l[11]=[y("yes")]))),_:1})):(g(),p(P,{key:1,color:"red",size:"small"},{default:r((()=>l[12]||(l[12]=[y("no")]))),_:1}))])),action:r((({record:e})=>[d(K,null,{default:r((()=>[m((g(),p(F,{title:"modify",onClick:t=>(e=>{var t;null==(t=J.value)||t.onUpdate(e.id)})(e)},{default:r((()=>l[13]||(l[13]=[y("modify")]))),_:2},1032,["onClick"])),[[X,["system:menu:update"]]]),m((g(),p(F,{status:"danger",title:"delete",onClick:t=>(e=>E((()=>C(e.id)),{content:`are you sure to delete the menu「${e.title}」?`,showModal:!0}))(e)},{default:r((()=>l[14]||(l[14]=[y("delete")]))),_:2},1032,["onClick"])),[[X,["system:menu:delete"]]]),m((g(),p(F,{disabled:![1,2].includes(e.type),title:[1,2].includes(e.type)?"add":"cannot add submenu",onClick:t=>L(e.id)},{default:r((()=>l[15]||(l[15]=[y(" 新增 ")]))),_:2},1032,["disabled","title","onClick"])),[[X,["system:menu:add"]]])])),_:2},1024)])),_:1},8,["data","loading","onRefresh"]),d(b,{ref_key:"MenuAddModalRef",ref:J,menus:u(U),onSaveSuccess:u(A)},null,8,["menus","onSaveSuccess"])])}}});export{S as default};
