import{_ as e}from"./index-DBV9O_Xv.js";import{d as a,r as l,A as t,L as s,c as i,w as r,f as u,a as c,h as o,C as d,t as n,k as p,o as m,M as f,x as v}from"./index-BAyZi_co.js";import{E as h}from"./regexp-DaVwsOyC.js";import{u as y}from"./tabs-D4ctZ4n_.js";import"./captcha-noq_IUbv.js";import"./encrypt-fe7GwHAY.js";import"./index-DVDBkEOF.js";const g=v(a({__name:"index",setup(a){const v=l(),g=t({email:"",captcha:""}),w={email:[{required:!0,message:"please enter email"},{match:h,message:"please enter correct email"}],captcha:[{required:!0,message:"please enter captcha"}]},_=s(),b=y(),x=p(),j=l(!1),V=async()=>{var e;try{if(await(null==(e=v.value)?void 0:e.validate()))return;j.value=!0,await _.emailLogin(g),b.reset();const{redirect:a,...l}=x.currentRoute.value.query;await x.push({path:a||"/",query:{...l}}),f.success("欢迎使用")}catch(a){g.captcha=""}finally{j.value=!1}},z=l(),k=l("blockPuzzle"),q=l("pop"),I=l(!1),R=async()=>{var e;if(I.value)return;await(null==(e=v.value)?void 0:e.validateField("email"))||z.value.show()},C=l(),L=l(60),S=l("获取验证码"),U=l(!1),$=()=>{window.clearInterval(C.value),L.value=60,S.value="获取验证码",U.value=!1},A=async e=>{try{I.value=!0,S.value="发送中...",I.value=!1,U.value=!0,S.value=`获取验证码(${L.value-=1}s)`,f.success("仅提供效果演示，实际使用请查看代码取消相关注释"),C.value=window.setInterval((()=>{L.value-=1,S.value=`获取验证码(${L.value}s)`,L.value<=0&&$()}),1e3)}catch(a){$()}finally{I.value=!1}};return(a,l)=>{const t=c("a-input"),s=c("a-form-item"),p=c("a-button"),f=c("a-space"),h=e,y=c("a-form");return m(),i(y,{ref_key:"formRef",ref:v,model:u(g),rules:w,"label-col-style":{display:"none"},"wrapper-col-style":{flex:1},size:"large",onSubmit:V},{default:r((()=>[o(s,{field:"email","hide-label":""},{default:r((()=>[o(t,{modelValue:u(g).email,"onUpdate:modelValue":l[0]||(l[0]=e=>u(g).email=e),placeholder:"please enter email","allow-clear":""},null,8,["modelValue"])])),_:1}),o(s,{field:"captcha","hide-label":""},{default:r((()=>[o(t,{modelValue:u(g).captcha,"onUpdate:modelValue":l[1]||(l[1]=e=>u(g).captcha=e),placeholder:"please enter captcha","max-length":4,"allow-clear":"",style:{flex:"1 1"}},null,8,["modelValue"]),o(p,{class:"captcha-btn",loading:u(I),disabled:u(U),size:"large",onClick:R},{default:r((()=>[d(n(u(S)),1)])),_:1},8,["loading","disabled"])])),_:1}),o(s,null,{default:r((()=>[o(f,{direction:"vertical",fill:"",class:"w-full"},{default:r((()=>[o(p,{disabled:"",class:"btn",type:"primary",loading:u(j),"html-type":"submit",size:"large",long:""},{default:r((()=>l[2]||(l[2]=[d("login")]))),_:1},8,["loading"])])),_:1})])),_:1}),o(h,{ref_key:"VerifyRef",ref:z,"captcha-type":u(k),mode:u(q),"img-size":{width:"330px",height:"155px"},onSuccess:A},null,8,["captcha-type","mode"])])),_:1},8,["model"])}}}),[["__scopeId","data-v-27ca863e"]]);export{g as default};
