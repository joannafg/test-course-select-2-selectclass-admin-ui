import{_ as e}from"./index-B7Sos0mo.js";import{_ as t}from"./GiCellStatus.vue_vue_type_script_setup_true_lang-27S6yIFO.js";import{_ as a}from"./index.vue_vue_type_script_setup_true_lang-D5x81qJP.js";import{_ as i}from"./AppAddModal.vue_vue_type_script_setup_true_lang-FI_YW5zv.js";import{_ as s}from"./AppDetailDrawer.vue_vue_type_script_setup_true_lang-BZFpz1T5.js";import{l as o,b as n,d as l,e as r,r as d}from"./app-lO4sNtGx.js";import{d as p,A as c,Z as u,a1 as m,r as _,b as f,h as y,w as h,f as k,a as x,G as w,c as v,C as g,e as C,g as b,a0 as j,o as I,O as K,M as S}from"./index-BAyZi_co.js";import{u as z}from"./useTable-DUTUCT70.js";import{u as A}from"./useDownload-C-k5xGNE.js";import{h as D}from"./has-CF2CDZHh.js";import"./index-FaVgdj3V.js";import"./GiForm-BWZRNfN-.js";import"./index.vue_vue_type_script_setup_true_lang-Dekw0iDL.js";import"./useResetReactive-NMdkdCz2.js";import"./useBreakpoint-C2fvcUp5.js";const O={class:"gi_table_page"},N=p({name:"OpenApp",__name:"index",setup(p){const N=c({sort:["id,desc"]}),{tableData:R,loading:M,pagination:T,search:U,handleDelete:B}=z((e=>o({...N,...e})),{immediate:!0}),G=[{title:"number",width:66,align:"center",render:({rowIndex:e})=>u("span",{},e+1+(T.current-1)*T.pageSize),fixed:m()?void 0:"left"},{title:"name",dataIndex:"name",slotName:"name",ellipsis:!0,tooltip:!0,fixed:m()?void 0:"left"},{title:"access key",dataIndex:"accessKey",slotName:"accessKey",width:200},{title:"secret key",dataIndex:"secretKey",slotName:"secretKey",width:200},{title:"expire time",dataIndex:"expireTime",width:180},{title:"status",dataIndex:"status",slotName:"status",width:80,align:"center"},{title:"description",dataIndex:"description",ellipsis:!0,tooltip:!0},{title:"create user",dataIndex:"createUserString",ellipsis:!0,tooltip:!0,show:!1},{title:"create time",dataIndex:"createTime",width:180},{title:"update user",dataIndex:"updateUserString",ellipsis:!0,tooltip:!0,show:!1},{title:"update time",dataIndex:"updateTime",width:180,show:!1},{title:"action",dataIndex:"action",slotName:"action",width:190,align:"center",fixed:m()?void 0:"right",show:D.hasPermOr(["open:app:detail","open:app:update","open:app:delete","open:app:resetSecret"])}],P=()=>{N.description=void 0,U()},V=()=>{A((()=>r(N)))},$=_(),q=()=>{var e;null==(e=$.value)||e.onAdd()},F=_();return(o,r)=>{const p=x("a-input-search"),c=x("icon-refresh"),u=x("a-button"),m=x("icon-plus"),_=x("icon-download"),z=a,A=x("icon-eye-invisible"),J=x("a-tooltip"),L=x("a-space"),W=x("icon-eye"),Z=t,E=x("a-link"),H=x("icon-more"),Q=x("a-doption"),X=x("a-dropdown"),Y=e,ee=j("permission");return I(),f("div",O,[y(Y,{title:"","row-key":"id",data:k(R),columns:G,loading:k(M),scroll:{x:"100%",y:"100%",minWidth:1300},pagination:k(T),"disabled-tools":["size"],"disabled-column-keys":["name"],onRefresh:k(U)},{"toolbar-left":h((()=>[y(p,{modelValue:k(N).description,"onUpdate:modelValue":r[0]||(r[0]=e=>k(N).description=e),placeholder:"search name/description","allow-clear":"",onSearch:k(U)},null,8,["modelValue","onSearch"]),y(u,{onClick:P},{icon:h((()=>[y(c)])),default:h((()=>r[1]||(r[1]=[g("reset")]))),_:1})])),"toolbar-right":h((()=>[w((I(),v(u,{type:"primary",onClick:q},{icon:h((()=>[y(m)])),default:h((()=>r[2]||(r[2]=[g("add")]))),_:1})),[[ee,["open:app:add"]]]),w((I(),v(u,{onClick:V},{icon:h((()=>[y(_)])),default:h((()=>r[3]||(r[3]=[g("export")]))),_:1})),[[ee,["open:app:export"]]])])),accessKey:h((({record:e})=>[y(z,{content:e.accessKey},null,8,["content"])])),secretKey:h((({record:e})=>[e.secretKey?(I(),v(L,{key:0,size:[2]},{default:h((()=>[y(z,{content:e.secretKey},null,8,["content"]),y(J,{content:"hide"},{default:h((()=>[y(u,{type:"text",size:"mini",onClick:t=>(e=>{e.secretKey=void 0})(e)},{icon:h((()=>[y(A,{size:"16"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)):(I(),v(L,{key:1,size:[2]},{default:h((()=>[r[4]||(r[4]=b("span",null,"********************",-1)),y(J,{content:"show"},{default:h((()=>[w((I(),v(u,{type:"text",size:"mini",onClick:t=>(async e=>{const{data:t}=await n(e.id);e.secretKey=t.secretKey})(e)},{icon:h((()=>[y(W,{size:"16"})])),_:2},1032,["onClick"])),[[ee,["open:app:secret"]]])])),_:2},1024)])),_:2},1024))])),status:h((({record:e})=>[y(Z,{status:e.status},null,8,["status"])])),action:h((({record:e})=>[y(L,null,{default:h((()=>[w((I(),v(E,{title:"details",onClick:t=>(e=>{var t;null==(t=F.value)||t.onOpen(e.id)})(e)},{default:h((()=>r[5]||(r[5]=[g("details")]))),_:2},1032,["onClick"])),[[ee,["open:app:detail"]]]),w((I(),v(E,{title:"modify",onClick:t=>(e=>{var t;null==(t=$.value)||t.onUpdate(e.id)})(e)},{default:h((()=>r[6]||(r[6]=[g("modify")]))),_:2},1032,["onClick"])),[[ee,["open:app:update"]]]),w((I(),v(E,{status:"danger",disabled:e.disabled,title:e.disabled?"forbidden to delete":"delete",onClick:t=>(e=>B((()=>l(e.id)),{content:`are you sure to delete the application「${e.name}」？`,showModal:!0}))(e)},{default:h((()=>r[7]||(r[7]=[g(" delete ")]))),_:2},1032,["disabled","title","onClick"])),[[ee,["open:app:delete"]]]),y(X,null,{content:h((()=>[w((I(),v(Q,{title:"reset secret",onClick:t=>(async e=>{K.warning({title:"prompt",content:`are you sure to reset the application「${e.name}」secret key？`,okButtonProps:{status:"warning"},hideCancel:!1,maskClosable:!1,onBeforeOk:async()=>{try{return await d(e.id),S.success("reset successfully"),U(),!0}catch(t){return!1}}})})(e)},{default:h((()=>r[8]||(r[8]=[g("reset secret")]))),_:2},1032,["onClick"])),[[ee,["open:app:resetSecret"]]])])),default:h((()=>[k(D).hasPermOr(["open:app:resetSecret"])?(I(),v(u,{key:0,type:"text",size:"mini",title:"更多"},{icon:h((()=>[y(H,{size:16})])),_:1})):C("",!0)])),_:2},1024)])),_:2},1024)])),_:1},8,["data","loading","pagination","onRefresh"]),y(i,{ref_key:"AppAddModalRef",ref:$,onSaveSuccess:k(U)},null,8,["onSaveSuccess"]),y(s,{ref_key:"AppDetailDrawerRef",ref:F},null,512)])}}});export{N as default};
