import{b as e}from"./index-FaVgdj3V.js";import{g as a,u as s,a as l}from"./app-lO4sNtGx.js";import{_ as t}from"./GiForm-BWZRNfN-.js";import{d as i,r as o,p as u,A as r,c as d,w as n,f as c,J as m,a as p,h as f,o as v,M as b}from"./index-BAyZi_co.js";import{u as h}from"./useResetReactive-NMdkdCz2.js";const w=i({__name:"AppAddModal",emits:["save-success"],setup(i,{expose:w,emit:x}){const y=x,{width:k}=e(),g=o(""),R=o(!1),j=u((()=>!!g.value)),_=u((()=>j.value?"修改应用":"新增应用")),V=o(),A={form:{size:"large"},btns:{hide:!0}},[T,U]=h({status:1}),z=r([{label:"name",field:"name",type:"input",rules:[{required:!0,message:"please enter name"}]},{label:"expire time",field:"expireTime",type:"date-picker",props:{placeholder:"please select expire time",showTime:!0}},{label:"description",field:"description",type:"textarea",props:{maxLength:200,autoSize:{minRows:3,maxRows:5}}},{label:"status",field:"status",type:"switch",props:{type:"round",checkedValue:1,uncheckedValue:2,checkedText:"enable",uncheckedText:"disable"}}]),F=()=>{var e,a;null==(a=null==(e=V.value)?void 0:e.formRef)||a.resetFields(),U()},L=async()=>{var e,a;try{return!(await(null==(a=null==(e=V.value)?void 0:e.formRef)?void 0:a.validate()))&&(j.value?(await s(T,g.value),b.success("modify successfully")):(await l(T),b.success("add successfully")),y("save-success"),!0)}catch(t){return!1}};return w({onAdd:()=>{F(),g.value="",R.value=!0},onUpdate:async e=>{F(),g.value=e;const{data:s}=await a(e);Object.assign(T,s),R.value=!0}}),(e,a)=>{const s=p("a-modal");return v(),d(s,{visible:c(R),"onUpdate:visible":a[1]||(a[1]=e=>m(R)?R.value=e:null),title:c(_),"mask-closable":!1,"esc-to-close":!1,width:c(k)>=500?500:"100%",draggable:"",onBeforeOk:L,onClose:F},{default:n((()=>[f(c(t),{ref_key:"formRef",ref:V,modelValue:c(T),"onUpdate:modelValue":a[0]||(a[0]=e=>m(T)?T.value=e:null),options:A,columns:c(z)},null,8,["modelValue","columns"])])),_:1},8,["visible","title","width"])}}});export{w as _};
