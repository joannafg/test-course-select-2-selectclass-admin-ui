import{b as e}from"./index-FaVgdj3V.js";import{g as s,c as a}from"./user-D7V0nsbJ.js";import{d as l,r as o,A as t,c as r,w as i,f as u,J as n,a as m,h as c,o as d,M as p}from"./index-BAyZi_co.js";import{_ as f}from"./GiForm-BWZRNfN-.js";import{u as v}from"./useResetReactive-NMdkdCz2.js";import{u as g}from"./useRole-BKbf4B3R.js";const w=l({__name:"UserUpdateRoleModal",emits:["save-success"],setup(l,{expose:w,emit:b}){const h=b,{width:R}=e(),j=o(""),y=o(!1),_=o(),{roleList:x,getRoleList:I}=g(),U={form:{size:"large"},btns:{hide:!0}},[V,k]=v({}),O=t([{label:"role",field:"roleIds",type:"select",options:x,props:{multiple:!0,allowClear:!0,allowSearch:{retainInputValue:!0}},rules:[{required:!0,message:"please select the role"}]}]),C=()=>{var e,s;null==(s=null==(e=_.value)?void 0:e.formRef)||s.resetFields(),k()},F=async()=>{var e,s;try{return!(await(null==(s=null==(e=_.value)?void 0:e.formRef)?void 0:s.validate()))&&(await a({roleIds:V.roleIds},j.value),p.success("assign successfully"),h("save-success"),!0)}catch(l){return!1}};return w({onOpen:async e=>{C(),j.value=e,x.value.length||await I();const{data:a}=await s(e);Object.assign(V,a),y.value=!0}}),(e,s)=>{const a=m("a-modal");return d(),r(a,{visible:u(y),"onUpdate:visible":s[1]||(s[1]=e=>n(y)?y.value=e:null),title:"assign role","mask-closable":!1,"esc-to-close":!1,width:u(R)>=600?600:"100%",draggable:"",onBeforeOk:F,onClose:C},{default:i((()=>[c(u(f),{ref_key:"formRef",ref:_,modelValue:u(V),"onUpdate:modelValue":s[0]||(s[0]=e=>n(V)?V.value=e:null),options:U,columns:u(O)},null,8,["modelValue","columns"])])),_:1},8,["visible","width"])}}});export{w as _};
