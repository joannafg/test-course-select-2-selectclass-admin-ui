import{b as e}from"./index-FaVgdj3V.js";import{d as a,r as l,B as t,c as s,a as u,f as i,w as d,h as o,e as _,C as n,G as L,M as r,O as A,a0 as M,o as S,x as m}from"./index-BAyZi_co.js";import{l as I,u as O,r as c}from"./option-1orMv3he.js";import{u as f}from"./useResetReactive-NMdkdCz2.js";const v=m(a({name:"MailSetting",__name:"MailSetting",setup(a){const{width:m}=e(),v=l(!1),R=l(),[p]=f({MAIL_PROTOCOL:"",MAIL_HOST:"",MAIL_PORT:0,MAIL_USERNAME:"",MAIL_PASSWORD:"",MAIL_SSL_ENABLED:"",MAIL_SSL_PORT:0}),P={MAIL_HOST:[{required:!0,message:"please enter the value"}],MAIL_PORT:[{required:!0,message:"please enter the value"}],MAIL_USERNAME:[{required:!0,message:"please enter the value"}],MAIL_PASSWORD:[{required:!0,message:"please enter the value"}],MAIL_SSL_PORT:[{required:!0,message:"please enter the value"}]},T=l({MAIL_PROTOCOL:{},MAIL_HOST:{},MAIL_PORT:{},MAIL_USERNAME:{},MAIL_PASSWORD:{},MAIL_SSL_ENABLED:{},MAIL_SSL_PORT:{}}),E=()=>{var e,a;null==(e=R.value)||e.resetFields(),p.MAIL_PROTOCOL=T.value.MAIL_PROTOCOL.value||"",p.MAIL_HOST=T.value.MAIL_HOST.value||"",p.MAIL_PORT=T.value.MAIL_PORT.value||0,p.MAIL_USERNAME=T.value.MAIL_USERNAME.value||"",p.MAIL_PASSWORD=(null==(a=T.value.MAIL_PASSWORD)?void 0:a.value)||"",p.MAIL_SSL_ENABLED=T.value.MAIL_SSL_ENABLED.value||"",p.MAIL_SSL_PORT=T.value.MAIL_SSL_PORT.value||0},h=l(!1),b=()=>{h.value=!0},k=()=>{E(),h.value=!1},y={category:"MAIL"},V=async()=>{v.value=!0;const{data:e}=await I(y);T.value=e.reduce(((e,a)=>(e[a.code]={...a,value:["MAIL_PORT","MAIL_SSL_PORT"].includes(a.code)?Number.parseInt(a.value):a.value},e)),{}),k(),v.value=!1},N=async()=>{var e;if(await(null==(e=R.value)?void 0:e.validate()))return!1;await O(Object.entries(p).map((([e,a])=>({id:T.value[e].id,code:e,value:a})))),await V(),r.success("save successfully")},w=async()=>{await c(y),r.success("restore successfully"),await V()},D=()=>{A.warning({title:"warning",content:"are you sure to restore the email configuration to the default value?",hideCancel:!1,maskClosable:!1,onOk:w})};return t((()=>{V()})),(e,a)=>{const l=u("a-option"),t=u("a-select"),r=u("a-form-item"),A=u("a-input"),I=u("a-input-number"),O=u("a-input-password"),c=u("a-switch"),f=u("icon-edit"),y=u("a-button"),V=u("icon-undo"),w=u("icon-save"),g=u("icon-refresh"),C=u("a-space"),U=u("a-form"),B=u("a-spin"),H=M("permission");return S(),s(B,{loading:i(v)},{default:d((()=>[o(U,{ref_key:"formRef",ref:R,model:i(p),rules:P,"auto-label-width":"","label-align":"left",layout:i(m)>=500?"horizontal":"vertical",disabled:!i(h),"scroll-to-first-error":""},{default:d((()=>{var e,u;return[o(r,{field:"MAIL_PROTOCOL",label:i(T).MAIL_PROTOCOL.name,"hide-asterisk":""},{default:d((()=>[o(t,{modelValue:i(p).MAIL_PROTOCOL,"onUpdate:modelValue":a[0]||(a[0]=e=>i(p).MAIL_PROTOCOL=e),modelModifiers:{trim:!0}},{default:d((()=>[o(l,{label:"SMTP",value:"smtp"})])),_:1},8,["modelValue"])])),_:1},8,["label"]),o(r,{field:"MAIL_HOST",label:i(T).MAIL_HOST.name,"hide-asterisk":""},{default:d((()=>[o(A,{modelValue:i(p).MAIL_HOST,"onUpdate:modelValue":a[1]||(a[1]=e=>i(p).MAIL_HOST=e),modelModifiers:{trim:!0},class:"input-width"},null,8,["modelValue"])])),_:1},8,["label"]),o(r,{field:"MAIL_PORT",label:i(T).MAIL_PORT.name,"hide-asterisk":""},{default:d((()=>[o(I,{modelValue:i(p).MAIL_PORT,"onUpdate:modelValue":a[2]||(a[2]=e=>i(p).MAIL_PORT=e),class:"input-width",min:0},null,8,["modelValue"])])),_:1},8,["label"]),o(r,{field:"MAIL_USERNAME",label:i(T).MAIL_USERNAME.name,"hide-asterisk":""},{default:d((()=>[o(A,{modelValue:i(p).MAIL_USERNAME,"onUpdate:modelValue":a[3]||(a[3]=e=>i(p).MAIL_USERNAME=e),modelModifiers:{trim:!0},class:"input-width"},null,8,["modelValue"])])),_:1},8,["label"]),o(r,{field:"MAIL_PASSWORD",label:null==(e=i(T).MAIL_PASSWORD)?void 0:e.name,"hide-asterisk":""},{default:d((()=>[o(O,{modelValue:i(p).MAIL_PASSWORD,"onUpdate:modelValue":a[4]||(a[4]=e=>i(p).MAIL_PASSWORD=e),modelModifiers:{trim:!0},class:"input-width"},null,8,["modelValue"])])),_:1},8,["label"]),o(r,{field:"MAIL_SSL_ENABLED",label:null==(u=i(T).MAIL_SSL_ENABLED)?void 0:u.name,"hide-asterisk":""},{default:d((()=>[o(c,{modelValue:i(p).MAIL_SSL_ENABLED,"onUpdate:modelValue":a[5]||(a[5]=e=>i(p).MAIL_SSL_ENABLED=e),type:"round","checked-value":1,"unchecked-value":0},{checked:d((()=>a[7]||(a[7]=[n("enable")]))),unchecked:d((()=>a[8]||(a[8]=[n("disable")]))),_:1},8,["modelValue"])])),_:1},8,["label"]),"1"===i(p).MAIL_SSL_ENABLED?(S(),s(r,{key:0,field:"MAIL_SSL_PORT",label:i(T).MAIL_SSL_PORT.name,"hide-asterisk":""},{default:d((()=>[o(I,{modelValue:i(p).MAIL_SSL_PORT,"onUpdate:modelValue":a[6]||(a[6]=e=>i(p).MAIL_SSL_PORT=e),class:"input-width",min:0},null,8,["modelValue"])])),_:1},8,["label"])):_("",!0),o(C,{style:{"margin-bottom":"16px"}},{default:d((()=>[i(h)?_("",!0):L((S(),s(y,{key:0,type:"primary",onClick:b},{icon:d((()=>[o(f)])),default:d((()=>[a[9]||(a[9]=n("modify "))])),_:1})),[[H,["system:config:update"]]]),i(h)?_("",!0):L((S(),s(y,{key:1,onClick:D},{icon:d((()=>[o(V)])),default:d((()=>[a[10]||(a[10]=n("restore "))])),_:1})),[[H,["system:config:reset"]]]),i(h)?(S(),s(y,{key:2,type:"primary",onClick:N},{icon:d((()=>[o(w)])),default:d((()=>[a[11]||(a[11]=n("save "))])),_:1})):_("",!0),i(h)?(S(),s(y,{key:3,onClick:E},{icon:d((()=>[o(g)])),default:d((()=>[a[12]||(a[12]=n("reset "))])),_:1})):_("",!0),i(h)?(S(),s(y,{key:4,onClick:k},{icon:d((()=>[o(V)])),default:d((()=>[a[13]||(a[13]=n("cancel "))])),_:1})):_("",!0)])),_:1})]})),_:1},8,["model","layout","disabled"])])),_:1},8,["loading"])}}}),[["__scopeId","data-v-3298e1e6"]]);export{v as default};
