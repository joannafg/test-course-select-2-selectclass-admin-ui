import{d as e,r as a,A as l,l as s,B as t,c as o,a as i,f as r,w as u,h as c,C as n,t as d,g as I,b as m,e as T,v as E,G as p,M as _,O as f,aE as S,a0 as v,o as O,x as C}from"./index-BAyZi_co.js";import{l as h,u as y,r as g}from"./option-1orMv3he.js";import{u as b}from"./useResetReactive-NMdkdCz2.js";const N={key:0,class:"arco-upload-list-picture custom-upload-avatar logo"},w=["src"],R={key:0,class:"arco-upload-list-picture-mask logo"},k={key:1,class:"arco-upload-picture-card logo"},V={class:"arco-upload-picture-card-text"},A={key:0,class:"arco-upload-list-picture custom-upload-avatar favicon"},G=["src"],L={key:0,class:"arco-upload-list-picture-mask favicon"},P={key:1,class:"arco-upload-picture-card favicon"},x={class:"arco-upload-picture-card-text"},B=C(e({name:"BasicSetting",__name:"BasicSetting",setup(e){const C=a(!1),B=a(),[F]=b({SITE_FAVICON:"",SITE_LOGO:"",SITE_TITLE:"",SITE_COPYRIGHT:""}),H={SITE_TITLE:[{required:!0,message:"please enter the system title"}],SITE_DESCRIPTION:[{required:!0,message:"please enter the system description"}],SITE_COPYRIGHT:[{required:!0,message:"please enter the copyright information"}]},Y=a({SITE_FAVICON:{},SITE_LOGO:{},SITE_TITLE:{},SITE_DESCRIPTION:{},SITE_COPYRIGHT:{},SITE_BEIAN:{}}),D=a({uid:"-1"}),q=a({uid:"-2"}),M=()=>{var e;null==(e=B.value)||e.resetFields(),F.SITE_FAVICON=Y.value.SITE_FAVICON.value||"",F.SITE_LOGO=Y.value.SITE_LOGO.value||"",F.SITE_TITLE=Y.value.SITE_TITLE.value||"",F.SITE_DESCRIPTION=Y.value.SITE_DESCRIPTION.value||"",F.SITE_COPYRIGHT=Y.value.SITE_COPYRIGHT.value||"",F.SITE_BEIAN=Y.value.SITE_BEIAN.value||"",D.value.url=Y.value.SITE_FAVICON.value,q.value.url=Y.value.SITE_LOGO.value},j=a(!1),U=()=>{j.value=!0},z=()=>{M(),j.value=!1},J=l({category:"SITE"}),K=async()=>{C.value=!0;const{data:e}=await h(J);Y.value=e.reduce(((e,a)=>(e[a.code]={...a},e)),{}),z(),C.value=!1},Q=s(),W=async()=>{var e;if(await(null==(e=B.value)?void 0:e.validate()))return!1;await y(Object.entries(F).map((([e,a])=>({id:Y.value[e].id,code:e,value:a})))),Q.setSiteConfig(F),await K(),_.success("save successfully")},X=async()=>{await g(J),_.success("restore successfully"),await K(),Q.setSiteConfig(F)},Z=()=>{f.warning({title:"warning",content:"are you sure to restore the basic configuration to the default value?",hideCancel:!1,maskClosable:!1,onOk:X})},$=e=>{const a=new AbortController;return async function(){const{onProgress:a,onError:l,onSuccess:s,fileItem:t}=e;a(20),t.file&&S(t.file).then().then((e=>{s(),F.SITE_FAVICON=e,_.success("upload successfully")})).catch((e=>{l(e)}))}(),{abort(){a.abort()}}},ee=(e,a)=>{D.value={...a}},ae=e=>{const a=new AbortController;return async function(){const{onProgress:a,onError:l,onSuccess:s,fileItem:t}=e;a(20),t.file&&S(t.file).then().then((e=>{s(),F.SITE_LOGO=e,_.success("upload successfully")})).catch((e=>{l(e)}))}(),{abort(){a.abort()}}},le=(e,a)=>{q.value={...a}};return t((()=>{K()})),(e,a)=>{const l=i("IconEdit"),s=i("icon-upload"),t=i("a-upload"),_=i("a-form-item"),f=i("a-input"),S=i("a-textarea"),h=i("icon-edit"),y=i("a-button"),g=i("icon-undo"),b=i("icon-save"),J=i("icon-refresh"),K=i("a-space"),Q=i("a-form"),X=i("a-spin"),se=v("permission");return O(),o(X,{loading:r(C)},{default:u((()=>[c(Q,{ref_key:"formRef",ref:B,model:r(F),rules:H,size:"large",layout:"vertical",disabled:!r(j),class:"form"},{default:u((()=>[c(_,{class:"image-item",field:"SITE_LOGO","hide-label":""},{extra:u((()=>[n(d(r(Y).SITE_LOGO.description)+" ",1),a[4]||(a[4]=I("br",null,null,-1)),c(t,{"file-list":r(q)?[r(q)]:[],accept:"image/*","show-file-list":!1,"custom-request":ae,onChange:le},{"upload-button":u((()=>[I("div",{class:E("arco-upload-list-item"+(r(q)&&"error"===r(q).status?" arco-upload-list-item-error":""))},[r(q)&&r(q).url?(O(),m("div",N,[I("img",{src:r(q).url,alt:"Logo"},null,8,w),r(j)?(O(),m("div",R,[c(l)])):T("",!0)])):(O(),m("div",k,[I("div",V,[c(s)])]))],2)])),_:1},8,["file-list"])])),default:u((()=>[n(d(r(Y).SITE_LOGO.name)+" ",1)])),_:1}),c(_,{class:"image-item",field:"SITE_FAVICON","hide-label":""},{extra:u((()=>[n(d(r(Y).SITE_FAVICON.description)+" ",1),a[5]||(a[5]=I("br",null,null,-1)),c(t,{"file-list":r(D)?[r(D)]:[],accept:"image/*","show-file-list":!1,"custom-request":$,onChange:ee},{"upload-button":u((()=>[I("div",{class:E("arco-upload-list-item"+(r(D)&&"error"===r(D).status?" arco-upload-list-item-error":""))},[r(D)&&r(D).url?(O(),m("div",A,[I("img",{src:r(D).url,alt:"favicon"},null,8,G),r(j)?(O(),m("div",L,[c(l)])):T("",!0)])):(O(),m("div",P,[I("div",x,[c(s)])]))],2)])),_:1},8,["file-list"])])),default:u((()=>[n(d(r(Y).SITE_FAVICON.name)+" ",1)])),_:1}),c(_,{class:"input-item",field:"SITE_TITLE",label:r(Y).SITE_TITLE.name},{default:u((()=>[c(f,{modelValue:r(F).SITE_TITLE,"onUpdate:modelValue":a[0]||(a[0]=e=>r(F).SITE_TITLE=e),modelModifiers:{trim:!0},class:"input-width",placeholder:"请输入系统标题","max-length":18,"show-word-limit":""},null,8,["modelValue"])])),_:1},8,["label"]),c(_,{class:"input-item",field:"SITE_DESCRIPTION",label:r(Y).SITE_DESCRIPTION.name},{default:u((()=>[c(S,{modelValue:r(F).SITE_DESCRIPTION,"onUpdate:modelValue":a[1]||(a[1]=e=>r(F).SITE_DESCRIPTION=e),modelModifiers:{trim:!0},class:"input-width",placeholder:"please enter the system description","auto-size":{minRows:1,maxRows:3}},null,8,["modelValue"])])),_:1},8,["label"]),c(_,{class:"input-item",field:"SITE_COPYRIGHT",label:r(Y).SITE_COPYRIGHT.name},{default:u((()=>[c(f,{modelValue:r(F).SITE_COPYRIGHT,"onUpdate:modelValue":a[2]||(a[2]=e=>r(F).SITE_COPYRIGHT=e),modelModifiers:{trim:!0},class:"input-width",placeholder:"please enter the copyright information"},null,8,["modelValue"])])),_:1},8,["label"]),c(_,{field:"SITE_BEIAN",label:r(Y).SITE_BEIAN.name},{default:u((()=>[c(f,{modelValue:r(F).SITE_BEIAN,"onUpdate:modelValue":a[3]||(a[3]=e=>r(F).SITE_BEIAN=e),modelModifiers:{trim:!0},class:"input-width",placeholder:"please enter the beian number","max-length":30,"show-word-limit":""},null,8,["modelValue"])])),_:1},8,["label"]),c(K,{style:{"margin-bottom":"16px"}},{default:u((()=>[r(j)?T("",!0):p((O(),o(y,{key:0,type:"primary",onClick:U},{icon:u((()=>[c(h)])),default:u((()=>[a[6]||(a[6]=n("modify "))])),_:1})),[[se,["system:config:update"]]]),r(j)?T("",!0):p((O(),o(y,{key:1,onClick:Z},{icon:u((()=>[c(g)])),default:u((()=>[a[7]||(a[7]=n("reset "))])),_:1})),[[se,["system:config:reset"]]]),r(j)?(O(),o(y,{key:2,type:"primary",onClick:W},{icon:u((()=>[c(b)])),default:u((()=>[a[8]||(a[8]=n("save "))])),_:1})):T("",!0),r(j)?(O(),o(y,{key:3,onClick:M},{icon:u((()=>[c(J)])),default:u((()=>[a[9]||(a[9]=n("reset "))])),_:1})):T("",!0),r(j)?(O(),o(y,{key:4,onClick:z},{icon:u((()=>[c(g)])),default:u((()=>[a[10]||(a[10]=n("cancel "))])),_:1})):T("",!0)])),_:1})])),_:1},8,["model","disabled"])])),_:1},8,["loading"])}}}),[["__scopeId","data-v-871273a9"]]);export{B as default};
