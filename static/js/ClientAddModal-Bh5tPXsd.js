import{b as e}from"./index-FaVgdj3V.js";import{C as t}from"./index-DVDBkEOF.js";import{g as l,u as s,a}from"./client-DWOcxWz8.js";import{_ as i}from"./GiForm-BWZRNfN-.js";import{D as n}from"./common-BtD_44m1.js";import{d as o,r,p as u,A as p,h as c,a as d,C as m,c as f,w as y,f as v,J as h,o as b,M as g,x as _}from"./index-BAyZi_co.js";import{u as x}from"./useResetReactive-NMdkdCz2.js";import{u as k}from"./useDict-ConFaTXJ.js";import"./index.vue_vue_type_script_setup_true_lang-Dekw0iDL.js";const w=_(o({__name:"ClientAddModal",emits:["save-success"],setup(o,{expose:_,emit:w}){const T=w,{width:j}=e(),q=r(""),C=r(!1),A=u((()=>!!q.value)),R=u((()=>A.value?"modify client":"add client")),D=r(),{client_type:S,auth_type_enum:M}=k("auth_type_enum","client_type"),U={form:{size:"large",layout:"vertical"},btns:{hide:!0},grid:{cols:2}},[V,z]=x({activeTimeout:1800,timeout:86400,isConcurrent:1,isShare:1,status:1}),F=()=>{const e=Date.now();V.clientSecret=t.MD5(`${e}`).toString(t.enc.Hex)},O=p([{label:"client key",field:"clientKey",type:"input",rules:[{required:!0,message:"please enter the client key"}],span:2,disabled:()=>A.value},{label:"client secret",field:"clientSecret",type:"input",rules:[{required:!0,message:"please enter the client secret"}],span:2,disabled:()=>A.value,slots:{append:()=>c(d("a-button"),{onClick:F},{default:"random generate",icon:c(d("icon-refresh"),null,null)})}},{label:"authentication type",field:"authType",type:"select",options:M,props:{multiple:!0,maxTagCount:2},rules:[{required:!0,message:"please select the authentication type"}]},{label:"client type",field:"clientType",type:"select",options:S,rules:[{required:!0,message:"please select the client type"}]},{label:()=>c(d("a-tooltip"),{content:"-1 permenantly not frozen"},{default:()=>[m("Token active timeout"),c(d("icon-info-circle-fill"),null,null)]}),field:"activeTimeout",type:"input-number",slots:{append:()=>c("span",{style:{width:"30px",textAlign:"center"}},[m("秒")])},props:{placeholder:"please enter the Token active timeout"},rules:[{required:!0,message:"please enter the Token active timeout"}]},{label:()=>c(d("a-tooltip"),{content:"-1 permenantly not expired"},{default:()=>[m("Token expiration"),c(d("icon-info-circle-fill"),null,null)]}),field:"timeout",type:"input-number",slots:{append:()=>c("span",{style:{width:"30px",textAlign:"center"}},[m("秒")])},props:{placeholder:"please enter the Token expiration"},rules:[{required:!0,message:"please enter the Token expiration"}]},{label:"status",field:"status",type:"radio-group",props:{type:"button",options:n},rules:[{required:!0,message:"please select the status"}]}]),B=()=>{var e,t;null==(t=null==(e=D.value)?void 0:e.formRef)||t.resetFields(),z()},G=async()=>{var e,t;try{return!(await(null==(t=null==(e=D.value)?void 0:e.formRef)?void 0:t.validate()))&&(A.value?(await s(V,q.value),g.success("modify successfully")):(await a(V),g.success("add successfully")),T("save-success"),!0)}catch(l){return!1}};return _({onAdd:async()=>{B(),q.value="",C.value=!0},onUpdate:async e=>{B(),q.value=e;const{data:t}=await l(e);Object.assign(V,t),C.value=!0}}),(e,t)=>{const l=d("a-modal");return b(),f(l,{visible:v(C),"onUpdate:visible":t[1]||(t[1]=e=>h(C)?C.value=e:null),title:v(R),"mask-closable":!1,"esc-to-close":!1,width:v(j)>=600?600:"100%",draggable:"",onBeforeOk:G,onClose:B},{default:y((()=>[c(v(i),{ref_key:"formRef",ref:D,modelValue:v(V),"onUpdate:modelValue":t[0]||(t[0]=e=>h(V)?V.value=e:null),options:U,columns:v(O)},null,8,["modelValue","columns"])])),_:1},8,["visible","title","width"])}}}),[["__scopeId","data-v-79561cca"]]);export{w as default};
