import{_ as e}from"./index-B7Sos0mo.js";import{$ as t,d as a,L as i,A as n,Z as o,a1 as s,b as l,h as r,w as d,f as c,a as m,G as u,c as p,C as k,t as g,M as h,a0 as f,o as x}from"./index-BAyZi_co.js";import{_}from"./index.vue_vue_type_script_setup_true_lang-Dekw0iDL.js";import{u as b}from"./useTable-DUTUCT70.js";import{h as w}from"./has-CF2CDZHh.js";import"./useBreakpoint-C2fvcUp5.js";import"./index-FaVgdj3V.js";const I="/monitor/online";const v={class:"gi_table_page"},y=a({name:"MonitorOnline",__name:"index",setup(a){const y=i().token,j=n({sort:["createTime,desc"]}),{tableData:T,loading:V,pagination:C,search:O}=b((e=>{return a={...j,...e},t.get(`${I}`,a);var a}),{immediate:!0}),$=[{title:"number",width:66,align:"center",render:({rowIndex:e})=>o("span",{},e+1+(C.current-1)*C.pageSize)},{title:"nickname",dataIndex:"nickname",slotName:"nickname",ellipsis:!0,tooltip:!0},{title:"login IP",dataIndex:"ip",ellipsis:!0,tooltip:!0},{title:"login address",dataIndex:"address",ellipsis:!0,tooltip:!0},{title:"browser",dataIndex:"browser",ellipsis:!0,tooltip:!0},{title:"terminal system",dataIndex:"os",ellipsis:!0,tooltip:!0},{title:"login time",dataIndex:"loginTime",width:180},{title:"last active time",dataIndex:"lastActiveTime",width:180},{title:"action",dataIndex:"action",slotName:"action",align:"center",fixed:s()?void 0:"right",show:w.hasPermOr(["monitor:online:kickout"])}],S=()=>{j.nickname=void 0,j.loginTime=void 0,O()},z=e=>{(function(e){return t.del(`${I}/${e}`)})(e).then((()=>{O(),h.success("kick out successfully")}))};return(t,a)=>{const i=m("a-input-search"),n=m("icon-refresh"),o=m("a-button"),s=m("a-link"),h=m("a-popconfirm"),b=m("a-space"),w=e,I=f("permission");return x(),l("div",v,[r(w,{title:"","row-key":"id",data:c(T),columns:$,loading:c(V),scroll:{x:"100%",y:"100%",minWidth:1e3},pagination:c(C),"disabled-tools":["size"],onRefresh:c(O)},{"toolbar-left":d((()=>[r(i,{modelValue:c(j).nickname,"onUpdate:modelValue":a[0]||(a[0]=e=>c(j).nickname=e),placeholder:"search by nickname","allow-clear":"",onSearch:c(O)},null,8,["modelValue","onSearch"]),r(_,{modelValue:c(j).loginTime,"onUpdate:modelValue":a[1]||(a[1]=e=>c(j).loginTime=e),onChange:c(O),placeholder:["select start time","select end time"]},null,8,["modelValue","onChange"]),r(o,{onClick:S},{icon:d((()=>[r(n)])),default:d((()=>a[2]||(a[2]=[k("reset")]))),_:1})])),nickname:d((({record:e})=>[k(g(e.nickname)+"("+g(e.username)+")",1)])),action:d((({record:e})=>[r(b,null,{default:d((()=>[r(h,{type:"warning",content:"are you sure to kick out the user?","ok-button-props":{status:"danger"},onOk:t=>z(e.token)},{default:d((()=>[u((x(),p(s,{status:"danger",title:c(y)===e.token?"can not kick out yourself":"kick out",disabled:c(y)===e.token},{default:d((()=>a[3]||(a[3]=[k(" kick out ")]))),_:2},1032,["title","disabled"])),[[I,["monitor:online:kickout"]]])])),_:2},1032,["onOk"])])),_:2},1024)])),_:1},8,["data","loading","pagination","onRefresh"])])}}});export{y as default};
